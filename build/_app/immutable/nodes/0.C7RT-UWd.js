import{_ as je}from"../chunks/PPVm8Dsz.js";import"../chunks/DsnmJJEf.js";import{a as Nr}from"../chunks/C6s76SRg.js";import{w as yt,b4 as Dr,a as ut,a9 as rr,f as sr,aa as x,ad as bt,a6 as I,s as pe,ab as qr,ac as nr,a7 as H,a8 as P,a5 as mt}from"../chunks/BsruwuOw.js";import{s as Br}from"../chunks/BRm6i2GJ.js";import"../chunks/CRqjmjq2.js";import{d as Mr}from"../chunks/Da8ga98m.js";import{g as Hr,c as Fr}from"../chunks/Q81dLJFU.js";const kt=[...` 	
\r\fÂ \v\uFEFF`];function Wr(n,e,t){var r=""+n;if(t){for(var s in t)if(t[s])r=r?r+" "+s:s;else if(r.length)for(var i=s.length,o=0;(o=r.indexOf(s,o))>=0;){var a=o+i;(o===0||kt.includes(r[o-1]))&&(a===r.length||kt.includes(r[a]))?r=(o===0?"":r.substring(0,o))+r.substring(a+1):o=a}}return r===""?null:r}function se(n,e,t,r,s,i){var o=n.__className;if(yt||o!==t||o===void 0){var a=Wr(t,r,i);(!yt||a!==n.getAttribute("class"))&&(a==null?n.removeAttribute("class"):n.className=a),n.__className=t}else if(i&&s!==i)for(var l in i){var c=!!i[l];(s==null||c!==!!s[l])&&n.classList.toggle(l,c)}return i}const Kr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>je(async()=>{const{default:r}=await Promise.resolve().then(()=>ke);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class ht extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class Ct extends ht{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Et extends ht{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class St extends ht{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Xe;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Xe||(Xe={}));var zr=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class Jr{constructor(e,{headers:t={},customFetch:r,region:s=Xe.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=Kr(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return zr(this,arguments,void 0,function*(t,r={}){var s;try{const{headers:i,method:o,body:a,signal:l}=r;let c={},{region:u}=r;u||(u=this.region);const h=new URL(`${this.url}/${t}`);u&&u!=="any"&&(c["x-region"]=u,h.searchParams.set("forceFunctionRegion",u));let d;a&&(i&&!Object.prototype.hasOwnProperty.call(i,"Content-Type")||!i)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(c["Content-Type"]="application/octet-stream",d=a):typeof a=="string"?(c["Content-Type"]="text/plain",d=a):typeof FormData<"u"&&a instanceof FormData?d=a:(c["Content-Type"]="application/json",d=JSON.stringify(a)));const f=yield this.fetch(h.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},c),this.headers),i),body:d,signal:l}).catch(w=>{throw w.name==="AbortError"?w:new Ct(w)}),g=f.headers.get("x-relay-error");if(g&&g==="true")throw new Et(f);if(!f.ok)throw new St(f);let p=((s=f.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),_;return p==="application/json"?_=yield f.json():p==="application/octet-stream"?_=yield f.blob():p==="text/event-stream"?_=f:p==="multipart/form-data"?_=yield f.formData():_=yield f.text(),{data:_,error:null,response:f}}catch(i){return i instanceof Error&&i.name==="AbortError"?{data:null,error:new Ct(i)}:{data:null,error:i,response:i instanceof St||i instanceof Et?i.context:void 0}}})}}function Vr(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Gr(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var j={},ne={},ie={},oe={},ae={},le={},Zr=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},me=Zr();const Yr=me.fetch,ir=me.fetch.bind(me),or=me.Headers,Qr=me.Request,Xr=me.Response,ke=Object.freeze(Object.defineProperty({__proto__:null,Headers:or,Request:Qr,Response:Xr,default:ir,fetch:Yr},Symbol.toStringTag,{value:"Module"})),es=Gr(ke);var xe={},Ot;function ar(){if(Ot)return xe;Ot=1,Object.defineProperty(xe,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return xe.default=n,xe}var Tt;function lr(){if(Tt)return le;Tt=1;var n=le&&le.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(le,"__esModule",{value:!0});const e=n(es),t=n(ar());class r{constructor(i){var o,a;this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=new Headers(i.headers),this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=(o=i.shouldThrowOnError)!==null&&o!==void 0?o:!1,this.signal=i.signal,this.isMaybeSingle=(a=i.isMaybeSingle)!==null&&a!==void 0?a:!1,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,o){return this.headers=new Headers(this.headers),this.headers.set(i,o),this}then(i,o){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const a=this.fetch;let l=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,h,d,f;let g=null,p=null,_=null,w=c.status,v=c.statusText;if(c.ok){if(this.method!=="HEAD"){const C=await c.text();C===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?p=C:p=JSON.parse(C))}const m=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),E=(d=c.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");m&&E&&E.length>1&&(_=parseInt(E[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(g={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,_=null,w=406,v="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const m=await c.text();try{g=JSON.parse(m),Array.isArray(g)&&c.status===404&&(p=[],g=null,w=200,v="OK")}catch{c.status===404&&m===""?(w=204,v="No Content"):g={message:m}}if(g&&this.isMaybeSingle&&(!((f=g?.details)===null||f===void 0)&&f.includes("0 rows"))&&(g=null,w=200,v="OK"),g&&this.shouldThrowOnError)throw new t.default(g)}return{error:g,data:p,count:_,status:w,statusText:v}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,h,d;return{error:{message:`${(u=c?.name)!==null&&u!==void 0?u:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(d=c?.code)!==null&&d!==void 0?d:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,o)}returns(){return this}overrideTypes(){return this}}return le.default=r,le}var At;function cr(){if(At)return ae;At=1;var n=ae&&ae.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ae,"__esModule",{value:!0});const e=n(lr());class t extends e.default{select(s){let i=!1;const o=(s??"*").split("").map(a=>/\s/.test(a)&&!i?"":(a==='"'&&(i=!i),a)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:i=!0,nullsFirst:o,foreignTable:a,referencedTable:l=a}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${s}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:i,referencedTable:o=i}={}){const a=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(a,`${s}`),this}range(s,i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"offset":`${a}.offset`,c=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${s}`),this.url.searchParams.set(c,`${i-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:i=!1,settings:o=!1,buffers:a=!1,wal:l=!1,format:c="text"}={}){var u;const h=[s?"analyze":null,i?"verbose":null,o?"settings":null,a?"buffers":null,l?"wal":null].filter(Boolean).join("|"),d=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${c}; for="${d}"; options=${h};`),c==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return ae.default=t,ae}var Rt;function dt(){if(Rt)return oe;Rt=1;var n=oe&&oe.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(oe,"__esModule",{value:!0});const e=n(cr());class t extends e.default{eq(s,i){return this.url.searchParams.append(s,`eq.${i}`),this}neq(s,i){return this.url.searchParams.append(s,`neq.${i}`),this}gt(s,i){return this.url.searchParams.append(s,`gt.${i}`),this}gte(s,i){return this.url.searchParams.append(s,`gte.${i}`),this}lt(s,i){return this.url.searchParams.append(s,`lt.${i}`),this}lte(s,i){return this.url.searchParams.append(s,`lte.${i}`),this}like(s,i){return this.url.searchParams.append(s,`like.${i}`),this}likeAllOf(s,i){return this.url.searchParams.append(s,`like(all).{${i.join(",")}}`),this}likeAnyOf(s,i){return this.url.searchParams.append(s,`like(any).{${i.join(",")}}`),this}ilike(s,i){return this.url.searchParams.append(s,`ilike.${i}`),this}ilikeAllOf(s,i){return this.url.searchParams.append(s,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(s,i){return this.url.searchParams.append(s,`ilike(any).{${i.join(",")}}`),this}is(s,i){return this.url.searchParams.append(s,`is.${i}`),this}in(s,i){const o=Array.from(new Set(i)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(s,`in.(${o})`),this}contains(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cs.{${i.join(",")}}`):this.url.searchParams.append(s,`cs.${JSON.stringify(i)}`),this}containedBy(s,i){return typeof i=="string"?this.url.searchParams.append(s,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(s,`cd.{${i.join(",")}}`):this.url.searchParams.append(s,`cd.${JSON.stringify(i)}`),this}rangeGt(s,i){return this.url.searchParams.append(s,`sr.${i}`),this}rangeGte(s,i){return this.url.searchParams.append(s,`nxl.${i}`),this}rangeLt(s,i){return this.url.searchParams.append(s,`sl.${i}`),this}rangeLte(s,i){return this.url.searchParams.append(s,`nxr.${i}`),this}rangeAdjacent(s,i){return this.url.searchParams.append(s,`adj.${i}`),this}overlaps(s,i){return typeof i=="string"?this.url.searchParams.append(s,`ov.${i}`):this.url.searchParams.append(s,`ov.{${i.join(",")}}`),this}textSearch(s,i,{config:o,type:a}={}){let l="";a==="plain"?l="pl":a==="phrase"?l="ph":a==="websearch"&&(l="w");const c=o===void 0?"":`(${o})`;return this.url.searchParams.append(s,`${l}fts${c}.${i}`),this}match(s){return Object.entries(s).forEach(([i,o])=>{this.url.searchParams.append(i,`eq.${o}`)}),this}not(s,i,o){return this.url.searchParams.append(s,`not.${i}.${o}`),this}or(s,{foreignTable:i,referencedTable:o=i}={}){const a=o?`${o}.or`:"or";return this.url.searchParams.append(a,`(${s})`),this}filter(s,i,o){return this.url.searchParams.append(s,`${i}.${o}`),this}}return oe.default=t,oe}var jt;function ur(){if(jt)return ie;jt=1;var n=ie&&ie.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ie,"__esModule",{value:!0});const e=n(dt());class t{constructor(s,{headers:i={},schema:o,fetch:a}){this.url=s,this.headers=new Headers(i),this.schema=o,this.fetch=a}select(s,i){const{head:o=!1,count:a}=i??{},l=o?"HEAD":"GET";let c=!1;const u=(s??"*").split("").map(h=>/\s/.test(h)&&!c?"":(h==='"'&&(c=!c),h)).join("");return this.url.searchParams.set("select",u),a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:i,defaultToNull:o=!0}={}){var a;const l="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const c=s.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}upsert(s,{onConflict:i,ignoreDuplicates:o=!1,count:a,defaultToNull:l=!0}={}){var c;const u="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),a&&this.headers.append("Prefer",`count=${a}`),l||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const h=s.reduce((d,f)=>d.concat(Object.keys(f)),[]);if(h.length>0){const d=[...new Set(h)].map(f=>`"${f}"`);this.url.searchParams.set("columns",d.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}update(s,{count:i}={}){var o;const a="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var i;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return ie.default=t,ie}var It;function ts(){if(It)return ne;It=1;var n=ne&&ne.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ne,"__esModule",{value:!0});const e=n(ur()),t=n(dt());class r{constructor(i,{headers:o={},schema:a,fetch:l}={}){this.url=i,this.headers=new Headers(o),this.schemaName=a,this.fetch=l}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new r(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:a=!1,get:l=!1,count:c}={}){var u;let h;const d=new URL(`${this.url}/rpc/${i}`);let f;a||l?(h=a?"HEAD":"GET",Object.entries(o).filter(([p,_])=>_!==void 0).map(([p,_])=>[p,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([p,_])=>{d.searchParams.append(p,_)})):(h="POST",f=o);const g=new Headers(this.headers);return c&&g.set("Prefer",`count=${c}`),new t.default({method:h,url:d,headers:g,schema:this.schemaName,body:f,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return ne.default=r,ne}var Pt;function rs(){if(Pt)return j;Pt=1;var n=j&&j.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(j,"__esModule",{value:!0}),j.PostgrestError=j.PostgrestBuilder=j.PostgrestTransformBuilder=j.PostgrestFilterBuilder=j.PostgrestQueryBuilder=j.PostgrestClient=void 0;const e=n(ts());j.PostgrestClient=e.default;const t=n(ur());j.PostgrestQueryBuilder=t.default;const r=n(dt());j.PostgrestFilterBuilder=r.default;const s=n(cr());j.PostgrestTransformBuilder=s.default;const i=n(lr());j.PostgrestBuilder=i.default;const o=n(ar());return j.PostgrestError=o.default,j.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:i.default,PostgrestError:o.default},j}var ss=rs();const ns=Vr(ss),{PostgrestClient:is,PostgrestQueryBuilder:Qi,PostgrestFilterBuilder:Xi,PostgrestTransformBuilder:eo,PostgrestBuilder:to,PostgrestError:ro}=ns;class os{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const as="2.74.0",ls=`realtime-js/${as}`,cs="1.0.0",et=1e4,us=1e3,hs=100;var Se;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Se||(Se={}));var R;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(R||(R={}));var q;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(q||(q={}));var tt;(function(n){n.websocket="websocket"})(tt||(tt={}));var Z;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Z||(Z={}));class ds{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const a=r.decode(e.slice(o,o+s));o=o+s;const l=r.decode(e.slice(o,o+i));o=o+i;const c=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{ref:null,topic:a,event:l,payload:c}}}class hr{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var S;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(S||(S={}));const xt=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=fs(o,n,e,s),i),{}):{}},fs=(n,e,t,r)=>{const s=e.find(a=>a.name===n),i=s?.type,o=t[n];return i&&!r.includes(i)?dr(i,o):rt(o)},dr=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return vs(e,t)}switch(n){case S.bool:return gs(e);case S.float4:case S.float8:case S.int2:case S.int4:case S.int8:case S.numeric:case S.oid:return ps(e);case S.json:case S.jsonb:return _s(e);case S.timestamp:return ws(e);case S.abstime:case S.date:case S.daterange:case S.int4range:case S.int8range:case S.money:case S.reltime:case S.text:case S.time:case S.timestamptz:case S.timetz:case S.tsrange:case S.tstzrange:return rt(e);default:return rt(e)}},rt=n=>n,gs=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},ps=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},_s=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},vs=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>dr(e,a))}return n},ws=n=>typeof n=="string"?n.replace(" ","T"):n,fr=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class We{constructor(e,t,r={},s=et){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var $t;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})($t||($t={}));class Oe{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Oe.syncState(this.state,s,i,o),this.pendingDiffs.forEach(l=>{this.state=Oe.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Oe.syncDiff(this.state,s,i,o),a())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),o=this.transformState(t),a={},l={};return this.map(i,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=i[c];if(h){const d=u.map(_=>_.presence_ref),f=h.map(_=>_.presence_ref),g=u.filter(_=>f.indexOf(_.presence_ref)<0),p=h.filter(_=>d.indexOf(_.presence_ref)<0);g.length>0&&(a[c]=g),p.length>0&&(l[c]=p)}else a[c]=u}),this.syncDiff(i,{joins:a,leaves:l},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(a,l)=>{var c;const u=(c=e[a])!==null&&c!==void 0?c:[];if(e[a]=this.cloneDeep(l),u.length>0){const h=e[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);e[a].unshift(...d)}r(a,u,l)}),this.map(o,(a,l)=>{let c=e[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),e[a]=c,s(a,c,l),c.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lt;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Lt||(Lt={}));var Te;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Te||(Te={}));var M;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(M||(M={}));class ft{constructor(e,t={config:{}},r){var s,i;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=R.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new We(this,q.join,this.params,this.timeout),this.rejoinTimer=new hr(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=R.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=R.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=R.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=R.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=R.errored,this.rejoinTimer.scheduleTimeout())}),this._on(q.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new Oe(this),this.broadcastEndpointURL=fr(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,i;if(this.socket.isConnected()||this.socket.connect(),this.state==R.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,c=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[Te.PRESENCE]&&this.bindings[Te.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,h={},d={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(f=>e?.(M.CHANNEL_ERROR,f)),this._onClose(()=>e?.(M.CLOSED)),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:f})=>{var g;if(this.socket.setAuth(),f===void 0){e?.(M.SUBSCRIBED);return}else{const p=this.bindings.postgres_changes,_=(g=p?.length)!==null&&g!==void 0?g:0,w=[];for(let v=0;v<_;v++){const y=p[v],{filter:{event:m,schema:E,table:C,filter:O}}=y,$=f&&f[v];if($&&$.event===m&&$.schema===E&&$.table===C&&$.filter===O)w.push(Object.assign(Object.assign({},y),{id:$.id}));else{this.unsubscribe(),this.state=R.errored,e?.(M.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,e&&e(M.SUBSCRIBED);return}}).receive("error",f=>{this.state=R.errored,e?.(M.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{e?.(M.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===R.joined&&e===Te.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:o}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,a,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=R.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(q.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new We(this,q.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=R.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(i),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new We(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>hs){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const o=e.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=q;if(r&&[a,l,c,u].indexOf(o)>=0&&r!==this._joinRef())return;let d=this._onMessage(o,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(f=>{var g,p,_;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((_=(p=f.filter)===null||p===void 0?void 0:p.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(f=>f.callback(d,r)):(i=this.bindings[o])===null||i===void 0||i.filter(f=>{var g,p,_,w,v,y;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const m=f.id,E=(g=f.filter)===null||g===void 0?void 0:g.event;return m&&((p=t.ids)===null||p===void 0?void 0:p.includes(m))&&(E==="*"||E?.toLocaleLowerCase()===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const m=(v=(w=f?.filter)===null||w===void 0?void 0:w.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return m==="*"||m===((y=t?.event)===null||y===void 0?void 0:y.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const g=d.data,{schema:p,table:_,commit_timestamp:w,type:v,errors:y}=g;d=Object.assign(Object.assign({},{schema:p,table:_,commit_timestamp:w,eventType:v,new:{},old:{},errors:y}),this._getPayloadRecords(g))}f.callback(d,r)})}_isClosed(){return this.state===R.closed}_isJoined(){return this.state===R.joined}_isJoining(){return this.state===R.joining}_isLeaving(){return this.state===R.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&ft.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(q.close,{},e)}_onError(e){this._on(q.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=R.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=xt(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=xt(e.columns,e.old_record)),t}}const Ke=()=>{},$e={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ys=[1e3,2e3,5e3,1e4],bs=1e4,ms=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ks{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=et,this.transport=null,this.heartbeatIntervalMs=$e.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ke,this.ref=0,this.reconnectTimer=null,this.logger=Ke,this.conn=null,this.sendBuffer=[],this.serializer=new ds,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>je(async()=>{const{default:a}=await Promise.resolve().then(()=>ke);return{default:a}},void 0,import.meta.url).then(({default:a})=>a(...o)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${tt.websocket}`,this.httpEndpoint=fr(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=os.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:cs}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Se.connecting:return Z.Connecting;case Se.open:return Z.Open;case Se.closing:return Z.Closing;default:return Z.Closed}}isConnected(){return this.connectionState()===Z.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new ft(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:r,payload:s,ref:i}=e,o=()=>{this.encode(e,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${t} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(us,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},$e.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:i,ref:o}=t,a=o?`(${o})`:"",l=i.status||"";this.log("receive",`${l} ${r} ${s} ${a}`.trim(),i),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(s,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(q.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([ms],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:ls};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(q.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new hr(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},$e.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,i,o,a,l,c,u;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:et,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:$e.HEARTBEAT_INTERVAL,this.worker=(i=e?.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=e?.heartbeatCallback)!==null&&a!==void 0?a:Ke,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e?.reconnectAfterMs)!==null&&l!==void 0?l:(h=>ys[h-1]||bs),this.encode=(c=e?.encode)!==null&&c!==void 0?c:((h,d)=>d(JSON.stringify(h))),this.decode=(u=e?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class gt extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function A(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Cs extends gt{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class st extends gt{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Es=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};const gr=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>je(async()=>{const{default:r}=await Promise.resolve().then(()=>ke);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},Ss=()=>Es(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield je(()=>Promise.resolve().then(()=>ke),void 0,import.meta.url)).Response:Response}),nt=n=>{if(Array.isArray(n))return n.map(t=>nt(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=nt(r)}),e},Os=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var ee=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};const ze=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Ts=(n,e,t)=>ee(void 0,void 0,void 0,function*(){const r=yield Ss();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const i=n.status||500,o=s?.statusCode||i+"";e(new Cs(ze(s),i,o))}).catch(s=>{e(new st(ze(s),s))}):e(new st(ze(n),n))}),As=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(Os(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function Ie(n,e,t,r,s,i){return ee(this,void 0,void 0,function*(){return new Promise((o,a)=>{n(t,As(e,r,s,i)).then(l=>{if(!l.ok)throw l;return r?.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>Ts(l,a,r))})})}function Ne(n,e,t,r){return ee(this,void 0,void 0,function*(){return Ie(n,"GET",e,t,r)})}function B(n,e,t,r,s){return ee(this,void 0,void 0,function*(){return Ie(n,"POST",e,r,s,t)})}function it(n,e,t,r,s){return ee(this,void 0,void 0,function*(){return Ie(n,"PUT",e,r,s,t)})}function Rs(n,e,t,r){return ee(this,void 0,void 0,function*(){return Ie(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function pr(n,e,t,r,s){return ee(this,void 0,void 0,function*(){return Ie(n,"DELETE",e,r,s,t)})}var js=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class Is{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return js(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(A(e))return{data:null,error:e};throw e}})}}var Ps=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class xs{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}asStream(){return new Is(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.execute().then(e,t)}execute(){return Ps(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(A(e))return{data:null,error:e};throw e}})}}var U=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};const $s={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ut={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Ls{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=gr(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return U(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},Ut),s);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),s?.headers&&(a=Object.assign(Object.assign({},a),s.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),h=yield(e=="PUT"?it:B)(this.fetch,`${this.url}/object/${u}`,i,Object.assign({headers:a},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(A(i))return{data:null,error:i};throw i}})}upload(e,t,r){return U(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return U(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:Ut.upsert},s),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const h=yield it(this.fetch,a.toString(),l,{headers:u});return{data:{path:i,fullPath:h.Key},error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(A(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return U(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const i=yield B(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new gt("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:a},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(A(r))return{data:null,error:r};throw r}})}update(e,t,r){return U(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return U(this,void 0,void 0,function*(){try{return{data:yield B(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(A(s))return{data:null,error:s};throw s}})}copy(e,t,r){return U(this,void 0,void 0,function*(){try{return{data:{path:(yield B(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(A(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return U(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield B(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(A(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return U(this,void 0,void 0,function*(){try{const s=yield B(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(A(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(t?.transform||{}),o=i?`?${i}`:"",a=this._getFinalPath(e),l=()=>Ne(this.fetch,`${this.url}/${s}/${a}${o}`,{headers:this.headers,noResolveJson:!0});return new xs(l,this.shouldThrowOnError)}info(e){return U(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Ne(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:nt(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(A(r))return{data:null,error:r};throw r}})}exists(e){return U(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Rs(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(A(r)&&r instanceof st){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const a=typeof t?.transform<"u"?"render/image":"object",l=this.transformOptsToQueryString(t?.transform||{});l!==""&&s.push(l);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${c}`)}}}remove(e){return U(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(A(t))return{data:null,error:t};throw t}})}list(e,t,r){return U(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},$s),t),{prefix:e||""});return{data:yield B(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(A(s))return{data:null,error:s};throw s}})}listV2(e,t){return U(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield B(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(A(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Us="2.74.0",Ns={"X-Client-Info":`storage-js/${Us}`};var ce=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class Ds{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const i=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Ns),t),this.fetch=gr(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return ce(this,void 0,void 0,function*(){try{return{data:yield Ne(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(A(e))return{data:null,error:e};throw e}})}getBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield Ne(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(A(t))return{data:null,error:t};throw t}})}createBucket(e){return ce(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield B(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(A(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return ce(this,void 0,void 0,function*(){try{return{data:yield it(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(A(r))return{data:null,error:r};throw r}})}emptyBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield B(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(A(t))return{data:null,error:t};throw t}})}deleteBucket(e){return ce(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(A(t))return{data:null,error:t};throw t}})}}class qs extends Ds{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new Ls(this.url,this.headers,e,this.fetch)}}const Bs="2.74.0";let Ee="";typeof Deno<"u"?Ee="deno":typeof document<"u"?Ee="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ee="react-native":Ee="node";const Ms={"X-Client-Info":`supabase-js-${Ee}/${Bs}`},Hs={headers:Ms},Fs={schema:"public"},Ws={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Ks={};var zs=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};const Js=n=>{let e;return n?e=n:typeof fetch>"u"?e=ir:e=fetch,(...t)=>e(...t)},Vs=()=>typeof Headers>"u"?or:Headers,Gs=(n,e,t)=>{const r=Js(t),s=Vs();return(i,o)=>zs(void 0,void 0,void 0,function*(){var a;const l=(a=yield e())!==null&&a!==void 0?a:n;let c=new s(o?.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),r(i,Object.assign(Object.assign({},o),{headers:c}))})};var Zs=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};function Ys(n){return n.endsWith("/")?n:n+"/"}function Qs(n,e){var t,r;const{db:s,auth:i,realtime:o,global:a}=n,{db:l,auth:c,realtime:u,global:h}=e,d={db:Object.assign(Object.assign({},l),s),auth:Object.assign(Object.assign({},c),i),realtime:Object.assign(Object.assign({},u),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},(t=h?.headers)!==null&&t!==void 0?t:{}),(r=a?.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Zs(this,void 0,void 0,function*(){return""})};return n.accessToken?d.accessToken=n.accessToken:delete d.accessToken,d}function Xs(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ys(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const _r="2.74.0",_e=30*1e3,ot=3,Je=ot*_e,en="http://localhost:9999",tn="supabase.auth.token",rn={"X-Client-Info":`gotrue-js/${_r}`},at="X-Supabase-Api-Version",vr={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},sn=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,nn=600*1e3;class Ae extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function b(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class on extends Ae{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function an(n){return b(n)&&n.name==="AuthApiError"}class Y extends Ae{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class z extends Ae{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class W extends z{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function ln(n){return b(n)&&n.name==="AuthSessionMissingError"}class ue extends z{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Le extends z{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ue extends z{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function cn(n){return b(n)&&n.name==="AuthImplicitGrantRedirectError"}class Nt extends z{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class lt extends z{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ve(n){return b(n)&&n.name==="AuthRetryableFetchError"}class Dt extends z{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class ct extends z{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const De="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),qt=` 	
\r=`.split(""),un=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<qt.length;e+=1)n[qt[e].charCodeAt(0)]=-2;for(let e=0;e<De.length;e+=1)n[De[e].charCodeAt(0)]=e;return n})();function Bt(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(De[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(De[r]),e.queuedBits-=6}}function wr(n,e,t){const r=un[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Mt(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{fn(o,r,t)};for(let o=0;o<n.length;o+=1)wr(n.charCodeAt(o),s,i);return e.join("")}function hn(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function dn(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}hn(r,e)}}function fn(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function ye(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)wr(n.charCodeAt(s),t,r);return new Uint8Array(e)}function gn(n){const e=[];return dn(n,t=>e.push(t)),new Uint8Array(e)}function Q(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>Bt(s,t,r)),Bt(null,t,r),e.join("")}function pn(n){return Math.round(Date.now()/1e3)+n}function _n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const N=()=>typeof window<"u"&&typeof document<"u",J={tested:!1,writable:!1},yr=()=>{if(!N())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(J.tested)return J.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),J.tested=!0,J.writable=!0}catch{J.tested=!0,J.writable=!1}return J.writable};function vn(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const br=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>je(async()=>{const{default:r}=await Promise.resolve().then(()=>ke);return{default:r}},void 0,import.meta.url).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},wn=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ve=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},V=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},F=async(n,e)=>{await n.removeItem(e)};class Fe{constructor(){this.promise=new Fe.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Fe.promiseConstructor=Promise;function Ge(n){const e=n.split(".");if(e.length!==3)throw new ct("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!sn.test(e[r]))throw new ct("JWT not in base64url format");return{header:JSON.parse(Mt(e[0])),payload:JSON.parse(Mt(e[1])),signature:ye(e[2]),raw:{header:e[0],payload:e[1]}}}async function yn(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function bn(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){r(o);return}}catch(o){if(!e(i,o)){s(o);return}}})()})}function mn(n){return("0"+n.toString(16)).substr(-2)}function kn(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,mn).join("")}async function Cn(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function En(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Cn(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function he(n,e,t=!1){const r=kn();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await ve(n,`${e}-code-verifier`,s);const i=await En(r);return[i,r===i?"plain":"s256"]}const Sn=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function On(n){const e=n.headers.get(at);if(!e||!e.match(Sn))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Tn(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function An(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Rn=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function de(n){if(!Rn.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ze(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Ht(n){return JSON.parse(JSON.stringify(n))}var jn=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const G=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),In=[502,503,504];async function Ft(n){var e;if(!wn(n))throw new lt(G(n),0);if(In.includes(n.status))throw new lt(G(n),n.status);let t;try{t=await n.json()}catch(i){throw new Y(G(i),i)}let r;const s=On(n);if(s&&s.getTime()>=vr["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Dt(G(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new W}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new Dt(G(t),n.status,t.weak_password.reasons);throw new on(G(t),n.status||500,r)}const Pn=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function k(n,e,t,r){var s;const i=Object.assign({},r?.headers);i[at]||(i[at]=vr["2024-01-01"].name),r?.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await xn(n,e,t+a,{headers:i,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(l):{data:Object.assign({},l),error:null}}async function xn(n,e,t,r,s,i){const o=Pn(e,r,s,i);let a;try{a=await n(t,Object.assign({},o))}catch(l){throw console.error(l),new lt(G(l),0)}if(a.ok||await Ft(a),r?.noResolveJson)return a;try{return await a.json()}catch(l){await Ft(l)}}function D(n){var e;let t=null;Un(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=pn(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Wt(n){const e=D(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function K(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function $n(n){return{data:n,error:null}}function Ln(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,o=jn(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function Kt(n){return n}function Un(n){return n.access_token&&n.refresh_token&&n.expires_in}const Ye=["global","local","others"];var Nn=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Dn{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=br(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=Ye[0]){if(Ye.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Ye.join(", ")}`);try{return await k(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await k(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:K})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Nn(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await k(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Ln,redirectTo:t?.redirectTo})}catch(t){if(b(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await k(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:K})}catch(t){if(b(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await k(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Kt});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(g.split(";")[1].split("=")[1]);c[`${_}Page`]=p}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(b(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){de(e);try{return await k(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:K})}catch(t){if(b(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){de(e);try{return await k(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:K})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){de(e);try{return await k(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:K})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){de(e.userId);try{const{data:t,error:r}=await k(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(b(t))return{data:null,error:t};throw t}}async _deleteFactor(e){de(e.userId),de(e.id);try{return{data:await k(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(b(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,i,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await k(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Kt});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(g=>{const p=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(g.split(";")[1].split("=")[1]);c[`${_}Page`]=p}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(b(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(e){try{return await k(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await k(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(e){try{return await k(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await k(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(b(t))return{data:null,error:t};throw t}}}function zt(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const fe={debug:!!(globalThis&&yr()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class mr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class qn extends mr{}async function Bn(n,e,t){fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),fe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw fe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new qn(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(fe.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function Mn(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function kr(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function Hn(n){return parseInt(n,16)}function Fn(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function Wn(n){var e;const{chainId:t,domain:r,expirationTime:s,issuedAt:i=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:h,version:d}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(d!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const f=kr(n.address),g=u?`${u}://${r}`:r,p=n.statement?`${n.statement}
`:"",_=`${g} wants you to sign in with your Ethereum account:
${f}

${p}`;let w=`URI: ${h}
Version: ${d}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(s&&(w+=`
Expiration Time: ${s.toISOString()}`),a&&(w+=`
Not Before: ${a.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let v=`
Resources:`;for(const y of c){if(!y||typeof y!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${y}`);v+=`
- ${y}`}w+=v}return`${_}
${w}`}class T extends Error{constructor({message:e,code:t,cause:r,name:s}){var i;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(i=s??(r instanceof Error?r.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class qe extends T{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function Kn({error:n,options:e}){var t,r,s;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new T({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new T({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new T({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new T({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new T({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new T({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return i.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new T({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new T({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(Er(o)){if(i.rp.id!==o)return new T({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new T({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new T({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new T({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new T({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function zn({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new T({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new T({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(Er(r)){if(t.rpId!==r)return new T({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new T({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new T({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new T({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}var Cr=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Jn{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const Vn=new Jn;function Gn(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,s=Cr(n,["challenge","user","excludeCredentials"]),i=ye(e).buffer,o=Object.assign(Object.assign({},t),{id:ye(t.id).buffer}),a=Object.assign(Object.assign({},s),{challenge:i,user:o});if(r&&r.length>0){a.excludeCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];a.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:ye(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function Zn(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=Cr(n,["challenge","allowCredentials"]),s=ye(e).buffer,i=Object.assign(Object.assign({},r),{challenge:s});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const a=t[o];i.allowCredentials[o]=Object.assign(Object.assign({},a),{id:ye(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return i}function Yn(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:Q(new Uint8Array(n.response.attestationObject)),clientDataJSON:Q(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Qn(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Q(new Uint8Array(s.authenticatorData)),clientDataJSON:Q(new Uint8Array(s.clientDataJSON)),signature:Q(new Uint8Array(s.signature)),userHandle:s.userHandle?Q(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function Er(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Jt(){var n,e;return!!(N()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function Xn(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qe("Browser returned unexpected credential type",e)}:{data:null,error:new qe("Empty credential response",e)}}catch(e){return{data:null,error:Kn({error:e,options:n})}}}async function ei(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new qe("Browser returned unexpected credential type",e)}:{data:null,error:new qe("Empty credential response",e)}}catch(e){return{data:null,error:zn({error:e,options:n})}}}const ti={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},ri={userVerification:"preferred",hints:["security-key"]};function Be(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of n)if(s)for(const i in s){const o=s[i];if(o!==void 0)if(Array.isArray(o))r[i]=o;else if(t(o))r[i]=o;else if(e(o)){const a=r[i];e(a)?r[i]=Be(a,o):r[i]=Be(o)}else r[i]=o}return r}function si(n,e){return Be(ti,n,e||{})}function ni(n,e){return Be(ri,n,e||{})}class ii{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},i){try{const{data:o,error:a}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:a};const l=s??Vn.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:c}=o.webauthn.credential_options.publicKey;c.name||(c.name=`${c.id}:${r}`),c.displayName||(c.displayName=c.name)}switch(o.webauthn.type){case"create":{const c=si(o.webauthn.credential_options.publicKey,i?.create),{data:u,error:h}=await Xn({publicKey:c,signal:l});return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}case"request":{const c=ni(o.webauthn.credential_options.publicKey,i?.request),{data:u,error:h}=await ei(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:c,signal:l}));return u?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:u}},error:null}:{data:null,error:h}}}}catch(o){return b(o)?{data:null,error:o}:{data:null,error:new Y("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}},i){if(!t)return{data:null,error:new Ae("rpId is required for WebAuthn authentication")};try{if(!Jt())return{data:null,error:new Y("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:i});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:l.type,rpId:t,rpOrigins:r,credential_response:l.credential_response}})}catch(o){return b(o)?{data:null,error:o}:{data:null,error:new Y("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s},i){if(!t)return{data:null,error:new Ae("rpId is required for WebAuthn registration")};try{if(!Jt())return{data:null,error:new Y("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(d=>d.factor_type==="webauthn"&&d.friendly_name===e&&d.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:a};const{data:l,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:i});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:t,rpOrigins:r,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(o){return b(o)?{data:null,error:o}:{data:null,error:new Y("Unexpected error in register",o)}}}}Mn();const oi={url:en,storageKey:tn,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:rn,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Vt(n,e,t){return await t()}const ge={};class Re{get jwks(){var e,t;return(t=(e=ge[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){ge[this.storageKey]=Object.assign(Object.assign({},ge[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=ge[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){ge[this.storageKey]=Object.assign(Object.assign({},ge[this.storageKey]),{cachedAt:e})}constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Re.nextInstanceID,Re.nextInstanceID+=1,this.instanceID>0&&N()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},oi),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Dn({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=br(s.fetch),this.lock=s.lock||Vt,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:N()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=Bn:this.lock=Vt,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new ii(this)},this.persistSession?(s.storage?this.storage=s.storage:yr()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=zt(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=zt(this.memoryStorage)),N()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${_r}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=vn(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),N()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(t,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),cn(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:a}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return b(t)?{error:t}:{error:new Y("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:D}),{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,r,s;try{let i;if("email"in e){const{email:u,password:h,options:d}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await he(this.storage,this.storageKey)),i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:u,password:h,data:(t=d?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:g},xform:D})}else if("phone"in e){const{phone:u,password:h,options:d}=e;i=await k(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},channel:(s=d?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:D})}else throw new Le("You must provide either an email or phone number and a password");const{data:o,error:a}=i;if(a||!o)return{data:{user:null,session:null},error:a};const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(b(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:a}=e;t=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Wt})}else if("phone"in e){const{phone:i,password:o,options:a}=e;t=await k(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Wt})}else throw new Le("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ue}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,i,o,a,l,c,u,h,d;let f,g;if("message"in e)f=e.message,g=e.signature;else{const{chain:p,wallet:_,statement:w,options:v}=e;let y;if(N())if(typeof _=="object")y=_;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")y=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!v?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");y=_}const m=new URL((t=v?.url)!==null&&t!==void 0?t:window.location.href),E=await y.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const C=kr(E[0]);let O=(r=v?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!O){const L=await y.request({method:"eth_chainId"});O=Hn(L)}const $={domain:m.host,address:C,statement:w,uri:m.href,version:"1",chainId:O,nonce:(s=v?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(i=v?.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=v?.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=v?.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=v?.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=v?.signInWithEthereum)===null||u===void 0?void 0:u.resources};f=Wn($),g=await y.request({method:"personal_sign",params:[Fn(f),C]})}try{const{data:p,error:_}=await k(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:g},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=e.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:D});if(_)throw _;return!p||!p.session||!p.user?{data:{user:null,session:null},error:new ue}:(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("SIGNED_IN",p.session)),{data:Object.assign({},p),error:_})}catch(p){if(b(p))return{data:{user:null,session:null},error:p};throw p}}async signInWithSolana(e){var t,r,s,i,o,a,l,c,u,h,d,f;let g,p;if("message"in e)g=e.message,p=e.signature;else{const{chain:_,wallet:w,statement:v,options:y}=e;let m;if(N())if(typeof w=="object")m=w;else{const C=window;if("solana"in C&&typeof C.solana=="object"&&("signIn"in C.solana&&typeof C.solana.signIn=="function"||"signMessage"in C.solana&&typeof C.solana.signMessage=="function"))m=C.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!y?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");m=w}const E=new URL((t=y?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in m&&m.signIn){const C=await m.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},y?.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),v?{statement:v}:null));let O;if(Array.isArray(C)&&C[0]&&typeof C[0]=="object")O=C[0];else if(C&&typeof C=="object"&&"signedMessage"in C&&"signature"in C)O=C;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in O&&"signature"in O&&(typeof O.signedMessage=="string"||O.signedMessage instanceof Uint8Array)&&O.signature instanceof Uint8Array)g=typeof O.signedMessage=="string"?O.signedMessage:new TextDecoder().decode(O.signedMessage),p=O.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in m)||typeof m.signMessage!="function"||!("publicKey"in m)||typeof m!="object"||!m.publicKey||!("toBase58"in m.publicKey)||typeof m.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${E.host} wants you to sign in with your Solana account:`,m.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(s=(r=y?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=y?.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...!((o=y?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...!((a=y?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...!((l=y?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...!((c=y?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...!((h=(u=y?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...y.signInWithSolana.resources.map(O=>`- ${O}`)]:[]].join(`
`);const C=await m.signMessage(new TextEncoder().encode(g),"utf8");if(!C||!(C instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");p=C}}try{const{data:_,error:w}=await k(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:Q(p)},!((d=e.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:D});if(w)throw w;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new ue}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:w})}catch(_){if(b(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const t=await V(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:i,error:o}=await k(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:D});if(await F(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new ue}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(b(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:i,nonce:o}=e,a=await k(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:D}),{data:l,error:c}=a;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new ue}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,o;try{if("email"in e){const{email:a,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await he(this.storage,this.storageKey));const{error:h}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=l?.data)!==null&&t!==void 0?t:{},create_user:(r=l?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:a,options:l}=e,{data:c,error:u}=await k(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(s=l?.data)!==null&&s!==void 0?s:{},create_user:(i=l?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:c?.message_id},error:u}}throw new Le("You must provide either an email or phone number.")}catch(a){if(b(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{let s,i;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:a}=await k(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:D});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(b(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await he(this.storage,this.storageKey)),await k(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:$n})}catch(i){if(b(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new W;const{error:s}=await k(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(b(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:o}=await k(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:o,error:a}=await k(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:o?.message_id},error:a}}throw new Le("You must provide either an email or phone number and a type")}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await V(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Je:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await V(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=Ze()}if(this.storage.isServer&&e.user){let o=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!o&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:K}):await this._useSession(async t=>{var r,s,i;const{data:o,error:a}=t;if(a)throw a;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new W}:await k(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:K})})}catch(t){if(b(t))return ln(t)&&(await this._removeSession(),await F(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new W;const o=s.session;let a=null,l=null;this.flowType==="pkce"&&e.email!=null&&([a,l]=await he(this.storage,this.storageKey));const{data:c,error:u}=await k(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:K});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(b(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new W;const t=Date.now()/1e3;let r=t,s=!0,i=null;const{payload:o}=Ge(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{data:a,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!a)return{data:{user:null,session:null},error:null};i=a}else{const{data:a,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(b(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:a}=t;if(a)throw a;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new W;const{data:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(b(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!N())throw new Ue("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ue(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Nt("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ue("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Nt("No code detected.");const{data:v,error:y}=await this._exchangeCodeForSession(e.code);if(y)throw y;const m=new URL(window.location.href);return m.searchParams.delete("code"),window.history.replaceState(window.history.state,"",m.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=e;if(!i||!a||!o||!c)throw new Ue("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=_e&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const g=d-h;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,d,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,d,u);const{data:p,error:_}=await this._getUser(i);if(_)throw _;const w={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(r){if(b(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await V(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:a}=await this.admin.signOut(o,e);if(a&&!(an(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await F(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=_n(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:i},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await he(this.storage,this.storageKey,!0));try{return await k(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(b(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(b(t))return{data:null,error:t};throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async i=>{var o,a,l,c,u;const{data:h,error:d}=i;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await k(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(s)throw s;return N()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(b(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:i}}=t;if(s)throw s;const{options:o,provider:a,token:l,access_token:c,nonce:u}=e,h=await k(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=i?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:a,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:D}),{data:d,error:f}=h;return f?{data:{user:null,session:null},error:f}:!d||!d.session||!d.user?{data:{user:null,session:null},error:new ue}:(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),{data:d,error:f})}catch(s){if(b(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)throw o;return await k(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await bn(async s=>(s>0&&await yn(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await k(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:D})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Ve(i)&&Date.now()+o-r<_e})}catch(r){if(this._debug(t,"error",r),b(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),N()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await V(this.storage,this.storageKey);if(s&&this.userStorage){let o=await V(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await ve(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:Ze()}else if(s&&!s.user&&!s.user){const o=await V(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await F(this.storage,this.storageKey+"-user"),await ve(this.storage,this.storageKey,s)):s.user=Ze()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<Je;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Je}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Ve(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(s.access_token);!a&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new W;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Fe;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new W;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const a={data:i.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(i){if(this._debug(s,"error",i),b(i)){const o={data:null,error:i};return Ve(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(o),i.length>0){for(let a=0;a<i.length;a+=1)console.error(i[a]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await ve(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const i=Ht(s);await ve(this.storage,this.storageKey,i)}else{const s=Ht(t);await ve(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await F(this.storage,this.storageKey),await F(this.storage,this.storageKey+"-code-verifier"),await F(this.storage,this.storageKey+"-user"),this.userStorage&&await F(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&N()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),_e);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/_e);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${_e}ms, refresh threshold is ${ot} ticks`),s<=ot&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof mr)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!N()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await he(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(a.toString())}if(r?.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;return i?{data:null,error:i}:await k(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:l,error:c}=await k(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&l.type==="totp"&&(!((s=l?.totp)===null||s===void 0)&&s.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(b(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?Yn(e.webauthn.credential_response):Qn(e.webauthn.credential_response)})}:{code:e.code}),{data:a,error:l}=await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:l})})}catch(t){if(b(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:i}=t;if(i)return{data:null,error:i};const o=await k(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:Gn(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:Zn(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(b(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(i),i.status==="verified"&&s[i.factor_type].push(i);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Ge(s.access_token);let a=null;o.aal&&(a=o.aal);let l=a;((r=(t=s.user.factors)===null||t===void 0?void 0:t.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(l="aal2");const u=o.amr||[];return{data:{currentLevel:a,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(a=>a.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(a=>a.kid===e),r&&this.jwks_cached_at+nn>s)return r;const{data:i,error:o}=await k(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(a=>a.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:f,error:g}=await this.getSession();if(g||!f.session)return{data:null,error:g};r=f.session.access_token}const{header:s,payload:i,signature:o,raw:{header:a,payload:l}}=Ge(r);t?.allowExpired||Tn(i.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!c){const{error:f}=await this.getUser(r);if(f)throw f;return{data:{claims:i,header:s,signature:o},error:null}}const u=An(s.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,gn(`${a}.${l}`)))throw new ct("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(b(r))return{data:null,error:r};throw r}}}Re.nextInstanceID=0;const ai=Re;class li extends ai{constructor(e){super(e)}}var ci=function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function a(u){try{c(r.next(u))}catch(h){o(h)}}function l(u){try{c(r.throw(u))}catch(h){o(h)}}function c(u){u.done?i(u.value):s(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})};class ui{constructor(e,t,r){var s,i,o;this.supabaseUrl=e,this.supabaseKey=t;const a=Xs(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const l=`sb-${a.hostname.split(".")[0]}-auth-token`,c={db:Fs,realtime:Ks,auth:Object.assign(Object.assign({},Ws),{storageKey:l}),global:Hs},u=Qs(r??{},c);this.storageKey=(s=u.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(h,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=u.auth)!==null&&o!==void 0?o:{},this.headers,u.global.fetch),this.fetch=Gs(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new is(new URL("rest/v1",a).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new qs(this.storageUrl.href,this.headers,this.fetch,r?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new Jr(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return ci(this,void 0,void 0,function*(){var e,t;if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,storageKey:o,flowType:a,lock:l,debug:c},u,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new li({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),u),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:i,flowType:a,lock:l,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new ks(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Sr=(n,e,t)=>new ui(n,e,t);function hi(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}hi()&&console.warn("â ï¸  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Or="0.7.0";var Ce={},Gt;function di(){if(Gt)return Ce;Gt=1,Object.defineProperty(Ce,"__esModule",{value:!0}),Ce.parse=o,Ce.serialize=c;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,i=(()=>{const d=function(){};return d.prototype=Object.create(null),d})();function o(d,f){const g=new i,p=d.length;if(p<2)return g;const _=f?.decode||u;let w=0;do{const v=d.indexOf("=",w);if(v===-1)break;const y=d.indexOf(";",w),m=y===-1?p:y;if(v>m){w=d.lastIndexOf(";",v-1)+1;continue}const E=a(d,w,v),C=l(d,v,E),O=d.slice(E,C);if(g[O]===void 0){let $=a(d,v+1,m),L=l(d,m,$);const te=_(d.slice($,L));g[O]=te}w=m+1}while(w<p);return g}function a(d,f,g){do{const p=d.charCodeAt(f);if(p!==32&&p!==9)return f}while(++f<g);return g}function l(d,f,g){for(;f>g;){const p=d.charCodeAt(--f);if(p!==32&&p!==9)return f+1}return g}function c(d,f,g){const p=g?.encode||encodeURIComponent;if(!n.test(d))throw new TypeError(`argument name is invalid: ${d}`);const _=p(f);if(!e.test(_))throw new TypeError(`argument val is invalid: ${f}`);let w=d+"="+_;if(!g)return w;if(g.maxAge!==void 0){if(!Number.isInteger(g.maxAge))throw new TypeError(`option maxAge is invalid: ${g.maxAge}`);w+="; Max-Age="+g.maxAge}if(g.domain){if(!t.test(g.domain))throw new TypeError(`option domain is invalid: ${g.domain}`);w+="; Domain="+g.domain}if(g.path){if(!r.test(g.path))throw new TypeError(`option path is invalid: ${g.path}`);w+="; Path="+g.path}if(g.expires){if(!h(g.expires)||!Number.isFinite(g.expires.valueOf()))throw new TypeError(`option expires is invalid: ${g.expires}`);w+="; Expires="+g.expires.toUTCString()}if(g.httpOnly&&(w+="; HttpOnly"),g.secure&&(w+="; Secure"),g.partitioned&&(w+="; Partitioned"),g.priority)switch(typeof g.priority=="string"?g.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${g.priority}`)}if(g.sameSite)switch(typeof g.sameSite=="string"?g.sameSite.toLowerCase():g.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${g.sameSite}`)}return w}function u(d){if(d.indexOf("%")===-1)return d;try{return decodeURIComponent(d)}catch{return d}}function h(d){return s.call(d)==="[object Date]"}return Ce}var Zt=di();function be(){return typeof window<"u"&&typeof window.document<"u"}const X={path:"/",sameSite:"lax",httpOnly:!1,maxAge:400*24*60*60},fi=3180,gi=/^(.*)[.](0|[1-9][0-9]*)$/;function Me(n,e){if(n===e)return!0;const t=n.match(gi);return!!(t&&t[1]===e)}function Tr(n,e,t){const r=fi;let s=encodeURIComponent(e);if(s.length<=r)return[{name:n,value:e}];const i=[];for(;s.length>0;){let o=s.slice(0,r);const a=o.lastIndexOf("%");a>r-3&&(o=o.slice(0,a));let l="";for(;o.length>0;)try{l=decodeURIComponent(o);break}catch(c){if(c instanceof URIError&&o.at(-3)==="%"&&o.length>3)o=o.slice(0,o.length-3);else throw c}i.push(l),s=s.slice(o.length)}return i.map((o,a)=>({name:`${n}.${a}`,value:o}))}async function Yt(n,e){const t=await e(n);if(t)return t;let r=[];for(let s=0;;s++){const i=`${n}.${s}`,o=await e(i);if(!o)break;r.push(o)}return r.length>0?r.join(""):null}const He="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Qt=` 	
\r=`.split(""),pi=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Qt.length;e+=1)n[Qt[e].charCodeAt(0)]=-2;for(let e=0;e<He.length;e+=1)n[He[e].charCodeAt(0)]=e;return n})();function Ar(n){const e=[];let t=0,r=0;if(vi(n,i=>{for(t=t<<8|i,r+=8;r>=6;){const o=t>>r-6&63;e.push(He[o]),r-=6}}),r>0)for(t=t<<6-r,r=6;r>=6;){const i=t>>r-6&63;e.push(He[i]),r-=6}return e.join("")}function Xt(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0};let s=0,i=0;for(let o=0;o<n.length;o+=1){const a=n.charCodeAt(o),l=pi[a];if(l>-1)for(s=s<<6|l,i+=6;i>=8;)wi(s>>i-8&255,r,t),i-=8;else{if(l===-2)continue;throw new Error(`Invalid Base64-URL character "${n.at(o)}" at position ${o}`)}}return e.join("")}function _i(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function vi(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}_i(r,e)}}function wi(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}const we="base64-";function Rr(n,e){const t=n.cookies??null,r=n.cookieEncoding,s={},i={};let o,a;if(t)if("get"in t){const l=async c=>{const u=c.flatMap(d=>[d,...Array.from({length:5}).map((f,g)=>`${d}.${g}`)]),h=[];for(let d=0;d<u.length;d+=1){const f=await t.get(u[d]);!f&&typeof f!="string"||h.push({name:u[d],value:f})}return h};if(o=async c=>await l(c),"set"in t&&"remove"in t)a=async c=>{for(let u=0;u<c.length;u+=1){const{name:h,value:d,options:f}=c[u];d?await t.set(h,d,f):await t.remove(h,f)}};else if(e)a=async()=>{console.warn("@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.")};else throw new Error("@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)")}else if("getAll"in t)if(o=async()=>await t.getAll(),"setAll"in t)a=t.setAll;else if(e)a=async()=>{console.warn("@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.")};else throw new Error("@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)");else throw new Error(`@supabase/ssr: ${e?"createServerClient":"createBrowserClient"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${be()?" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.":""}`);else if(!e&&be()){const l=()=>{const c=Zt.parse(document.cookie);return Object.keys(c).map(u=>({name:u,value:c[u]??""}))};o=()=>l(),a=c=>{c.forEach(({name:u,value:h,options:d})=>{document.cookie=Zt.serialize(u,h,d)})}}else{if(e)throw new Error("@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)");o=()=>[],a=()=>{throw new Error("@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed")}}return e?{getAll:o,setAll:a,setItems:s,removedItems:i,storage:{isServer:!0,getItem:async l=>{if(typeof s[l]=="string")return s[l];if(i[l])return null;const c=await o([l]),u=await Yt(l,async d=>{const f=c?.find(({name:g})=>g===d)||null;return f?f.value:null});if(!u)return null;let h=u;return typeof u=="string"&&u.startsWith(we)&&(h=Xt(u.substring(we.length))),h},setItem:async(l,c)=>{l.endsWith("-code-verifier")&&await jr({getAll:o,setAll:a,setItems:{[l]:c},removedItems:{}},{cookieOptions:n?.cookieOptions??null,cookieEncoding:r}),s[l]=c,delete i[l]},removeItem:async l=>{delete s[l],i[l]=!0}}}:{getAll:o,setAll:a,setItems:s,removedItems:i,storage:{isServer:!1,getItem:async l=>{const c=await o([l]),u=await Yt(l,async d=>{const f=c?.find(({name:g})=>g===d)||null;return f?f.value:null});if(!u)return null;let h=u;return u.startsWith(we)&&(h=Xt(u.substring(we.length))),h},setItem:async(l,c)=>{const h=(await o([l]))?.map(({name:v})=>v)||[],d=new Set(h.filter(v=>Me(v,l)));let f=c;r==="base64url"&&(f=we+Ar(c));const g=Tr(l,f);g.forEach(({name:v})=>{d.delete(v)});const p={...X,...n?.cookieOptions,maxAge:0},_={...X,...n?.cookieOptions,maxAge:X.maxAge};delete p.name,delete _.name;const w=[...[...d].map(v=>({name:v,value:"",options:p})),...g.map(({name:v,value:y})=>({name:v,value:y,options:_}))];w.length>0&&await a(w)},removeItem:async l=>{const h=((await o([l]))?.map(({name:f})=>f)||[]).filter(f=>Me(f,l)),d={...X,...n?.cookieOptions,maxAge:0};delete d.name,h.length>0&&await a(h.map(f=>({name:f,value:"",options:d})))}}}}async function jr({getAll:n,setAll:e,setItems:t,removedItems:r},s){const i=s.cookieEncoding,o=s.cookieOptions??null,l=(await n([...t?Object.keys(t):[],...r?Object.keys(r):[]]))?.map(({name:f})=>f)||[],c=Object.keys(r).flatMap(f=>l.filter(g=>Me(g,f))),u=Object.keys(t).flatMap(f=>{const g=new Set(l.filter(w=>Me(w,f)));let p=t[f];i==="base64url"&&(p=we+Ar(p));const _=Tr(f,p);return _.forEach(w=>{g.delete(w.name)}),c.push(...g),_}),h={...X,...o,maxAge:0},d={...X,...o,maxAge:X.maxAge};delete h.name,delete d.name,await e([...c.map(f=>({name:f,value:"",options:h})),...u.map(({name:f,value:g})=>({name:f,value:g,options:d}))])}let Qe;function yi(n,e,t){const r=t?.isSingleton===!0||(!t||!("isSingleton"in t))&&be();if(r&&Qe)return Qe;const{storage:s}=Rr({...t,cookieEncoding:t?.cookieEncoding??"base64url"},!1),i=Sr(n,e,{...t,global:{...t?.global,headers:{...t?.global?.headers,"X-Client-Info":`supabase-ssr/${Or} createBrowserClient`}},auth:{...t?.auth,...t?.cookieOptions?.name?{storageKey:t.cookieOptions.name}:null,flowType:"pkce",autoRefreshToken:be(),detectSessionInUrl:be(),persistSession:!0,storage:s}});return r&&(Qe=i),i}function bi(n,e,t){const{storage:r,getAll:s,setAll:i,setItems:o,removedItems:a}=Rr({...t,cookieEncoding:t?.cookieEncoding??"base64url"},!0),l=Sr(n,e,{...t,global:{...t?.global,headers:{...t?.global?.headers,"X-Client-Info":`supabase-ssr/${Or} createServerClient`}},auth:{...t?.cookieOptions?.name?{storageKey:t.cookieOptions.name}:null,...t?.auth,flowType:"pkce",autoRefreshToken:!1,detectSessionInUrl:!1,persistSession:!0,storage:r}});return l.auth.onAuthStateChange(async c=>{(Object.keys(o).length>0||Object.keys(a).length>0)&&(c==="SIGNED_IN"||c==="TOKEN_REFRESHED"||c==="USER_UPDATED"||c==="PASSWORD_RECOVERY"||c==="SIGNED_OUT"||c==="MFA_CHALLENGE_VERIFIED")&&await jr({getAll:s,setAll:i,setItems:o,removedItems:a},{cookieOptions:t?.cookieOptions??null,cookieEncoding:t?.cookieEncoding??"base64url"})}),l}const er="https://fbxdhdedmnbvsnamxfrr.supabase.co",tr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZieGRoZGVkbW5idnNuYW14ZnJyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzE5NzI4MDMsImV4cCI6MjA0NzU0ODgwM30.13XDQYZ6o_ykUZSiJLpnFiw0EOGKVyxlWmKwklmAKv8",mi=async({data:n,depends:e,fetch:t})=>{e("supabase:auth");const r=be()?yi(er,tr,{global:{fetch:t}}):bi(er,tr,{global:{fetch:t},cookies:{getAll(){return n.cookies}}}),{data:{session:s}}=await r.auth.getSession(),{data:{user:i}}=await r.auth.getUser();return{session:s,supabase:r,user:i}},so=Object.freeze(Object.defineProperty({__proto__:null,load:mi},Symbol.toStringTag,{value:"Module"}));var ki=Dr('<svg class="Logo_Svg" viewBox="0 0 358 609" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M138.938 34.9779C136.538 25.8091 143.957 14.6705 150.976 9.23117C166.944 -3.15726 192.091 -1.43749 207.919 10.0211C212.748 13.5206 218.268 20.3898 220.377 25.979C221.237 27.9988 222.337 31.2884 220.377 32.9582C218.798 34.208 214.858 33.978 212.928 33.978C209.439 33.988 199.79 34.518 197.14 32.9582C193.781 30.9784 193.431 26.549 187.912 22.6295C177.183 14.9804 167.064 22.2095 162.935 32.9782H156.935L155.936 22.9794L151.936 31.9783L150.936 26.9789L146.937 32.9782L148.937 19.9798C143.607 24.6792 143.297 28.6787 140.938 34.9779H138.938ZM98.5429 42.9969C102.602 41.2671 107.562 41.977 111.941 41.977H136.938H226.927H253.923C255.913 41.977 259.732 41.7471 261.322 42.9969C263.232 44.5067 262.992 48.7362 262.902 50.9759C262.622 57.685 259.632 56.9651 253.923 56.9751H141.937L131.939 56.0252H119.94L103.942 56.9751C101.992 56.9351 99.3028 57.0751 97.963 55.3753C96.7631 53.8555 96.8831 49.886 96.9631 47.9763C97.0731 45.2266 96.9831 45.1666 98.5429 42.9969ZM166.934 77.9725C164.705 68.6636 168.524 68.0737 176.933 67.9737C179.433 67.9437 186.512 67.5538 188.332 68.9936C190.481 70.6934 189.881 79.1223 194.631 76.8026C198.17 75.0828 195.571 67.0738 201.8 68.3437C206.409 69.2836 203.83 76.7726 207.929 76.7726C211.769 76.7726 209.849 69.9335 213.238 68.6336C219.238 66.3139 218.748 77.1726 222.717 76.3527C226.127 75.6528 223.317 66.4339 230.786 68.3037C234.776 69.3036 234.986 79.7322 232.906 82.3719C231.336 84.3516 227.227 83.9717 224.927 83.8117H164.934H141.937C132.489 84.0817 125.459 85.9114 126.109 73.973V71.1233C127.069 68.3737 129.479 67.8237 130.919 69.5935C132.729 71.7932 130.979 77.2126 134.238 78.8024C140.828 82.0219 137.168 66.054 142.437 69.1436C145.207 70.7634 144.197 78.4924 148.937 78.4924C154.826 78.4924 151.206 66.9739 156.676 68.7136C159.005 69.4635 158.935 72.9131 159.825 74.9128C161.495 78.6824 163.355 78.5624 166.934 77.9725ZM98.5429 92.9906L111.941 91.9707H136.938H226.927H254.923L261.902 93.5705L262.922 103.969L261.322 110.228L251.923 111.968L232.926 110.968H123.94H103.942L97.963 109.368L96.9431 98.9698L98.5429 92.9906ZM88.5442 119.987C92.3537 118.367 96.8431 118.967 100.943 119.007H114.941L126.939 119.967H140.938L155.936 118.967H261.922C263.962 118.967 267.691 118.727 269.341 119.987C272.721 122.567 270.931 132.865 270.921 136.965C270.921 140.155 271.771 150.003 269.321 151.943C267.731 153.193 263.912 152.963 261.922 152.963H185.932L169.934 151.963H116.941L94.9433 152.963C92.9636 152.923 90.3439 153.073 88.9641 151.363C87.2143 149.203 86.9444 139.935 86.9444 136.965C86.9344 132.126 85.7445 123.897 88.5442 119.987ZM50.9489 542.914C43.8198 542.154 37.8006 537.984 31.9513 534.085C10.4941 519.746 0.655298 499.459 0.95526 473.922L3.78489 444.926L11.7839 365.936L17.1232 308.943L21.7826 265.949L27.3819 210.956C30.6015 188.768 40.4903 170.881 57.948 156.582C63.8873 151.713 72.1862 145.834 79.9452 144.964C81.2651 156.093 77.5156 152.683 70.1365 160.982C66.207 165.391 66.497 167.471 63.6673 170.791L58.6979 175.62C55.3384 179.12 49.4791 186.689 47.3294 190.958C42.0401 201.457 40.8902 213.485 39.7803 224.954L35.1209 269.948L27.122 348.938L21.6726 403.931L15.7834 457.924C15.1634 464.104 13.5637 477.312 14.1236 482.921C15.5134 496.809 22.2526 508.218 31.9513 517.917C35.2909 521.246 38.0306 523.996 41.9501 526.696C44.1598 528.215 48.6292 530.265 49.9291 532.305C51.3489 534.535 50.9489 540.174 50.9489 542.914ZM279.52 146.094C285.029 144.824 294.608 152.243 298.917 155.633C316.965 169.851 327.094 188.458 330.333 210.956L334.083 249.951L336.743 271.948L342.082 326.941L345.742 358.937L350.081 406.931L356.73 473.922C356.95 477.122 356.28 479.772 355.98 482.921C354.21 502.029 346.171 517.327 331.823 530.165C326.904 534.565 320.975 538.464 314.915 541.114C311.956 542.414 308.576 543.763 307.196 539.764C303.437 528.935 313.256 529.405 323.824 518.827C334.303 508.358 343.362 491.13 342.402 475.922L337.083 421.929L330.743 354.937L317.825 227.953C316.705 211.955 313.746 196.227 304.137 182.959L289.999 167.921C288.649 165.411 289.369 164.392 286.659 160.962C283.239 156.642 274.751 152.373 279.52 146.094ZM90.9439 160.172H153.936L170.934 160.922H186.932L198.93 159.962H237.925H264.922C268.041 159.982 274.191 159.932 276.86 161.302C280.71 163.272 281.18 167.021 280.86 170.941C280.31 177.69 275.211 176.95 269.921 176.96H169.934L154.936 175.96H85.9445C83.7848 175.96 80.1852 176.18 78.3754 174.94C74.5859 172.331 76.0457 165.091 79.2253 162.562C81.645 160.632 87.6243 160.862 90.9439 160.172ZM291.918 214.955C291.368 208.856 289.159 203.187 285.989 197.957C284.679 195.788 280.97 191.268 280.79 189.048C280.55 185.929 285.369 181.779 289.879 184.579C294.528 187.459 299.867 197.717 301.717 202.957C302.327 205.336 303.257 208.346 301.717 210.686C300.027 213.825 295.198 214.615 291.918 214.955ZM64.9472 214.955C61.6376 214.605 56.8782 213.685 54.9784 210.566C53.7386 208.506 54.3985 206.116 54.9784 203.956C56.1983 199.217 60.7377 188.238 65.2471 186.079C67.6568 184.929 74.016 187.359 76.9456 187.959C73.1861 196.817 68.1967 198.847 64.9472 214.955ZM259.922 189.958C259.892 192.218 260.212 195.318 258.323 196.957C256.713 198.347 253.903 197.927 252.523 201.107C250.354 206.106 254.893 215.625 247.864 216.905H242.925H197.93L180.932 215.955H147.937H119.94C117.401 215.955 110.391 216.395 108.542 214.935C106.342 213.195 106.982 207.576 106.942 204.956C106.902 202.797 106.982 200.217 105.342 198.557C103.352 196.537 96.7431 196.907 98.6029 192.258C99.6528 189.618 103.632 189.978 105.942 189.958H148.937H188.931L204.929 188.958H238.925L259.922 189.958ZM49.9491 217.955C55.3384 219.485 61.8475 222.584 66.9469 225.064L77.9455 230.263C80.6952 231.523 88.6341 235.402 90.3039 237.562C92.1937 240.012 90.8839 243.072 87.8343 243.431C85.4246 243.721 80.2752 241.232 77.9455 240.232L57.948 231.093C55.6183 229.923 50.209 227.803 49.0092 225.684C47.5893 223.164 48.9692 220.334 49.9491 217.955ZM269.921 235.952C279.04 231.133 299.787 219.605 308.896 217.955C309.336 220.354 310.206 223.344 308.896 225.574C307.716 227.543 303.937 229.543 301.917 230.643L283.919 239.372C281.9 240.252 278.03 242.302 275.96 242.252C272.281 242.172 270.761 238.982 269.921 235.952ZM151.936 229.953C153.786 228.423 155.646 226.414 157.975 225.674L188.931 224.954C206.079 225.154 236.385 233.303 251.923 240.702L270.921 249.491C274.031 250.941 277.74 252.24 278.59 255.99C280 262.279 274.901 261.709 270.921 260.069L241.925 247.271C206.219 234.073 166.694 231.803 129.939 242.382C116.821 246.151 104.342 252.04 91.9437 257.65C89.1341 258.92 81.3951 263.019 78.6154 260.939C76.6957 259.419 77.0656 256.3 78.6154 254.58C80.4652 252.37 87.9542 249.571 90.9439 248.171L113.941 238.472L130.899 233.693L136.218 230.883L145.937 227.953L146.937 229.953H147.937L148.937 226.954L151.936 229.953ZM51.9488 237.952L59.9378 241.512L61.9375 252.95L58.9679 283.946L54.1185 329.941L47.7793 394.932L43.9498 428.928C39.8803 428.498 34.281 426.978 32.5513 422.749C31.5714 420.329 32.7612 413.79 33.1012 410.93L35.9508 383.934L38.7905 354.937L44.7797 298.944L48.7792 258.95C49.4891 251.89 49.7091 244.741 51.9488 237.952ZM313.916 427.928L312.076 409.93L307.086 364.936L298.638 285.946L295.088 252.95C294.508 245.431 299.097 242.722 305.917 241.952L310.746 284.946L316.085 337.939L320.895 382.934L323.114 408.93C323.804 412.43 324.694 420.719 323.114 423.709C321.045 426.778 317.145 427.418 313.916 427.928ZM163.935 250.161H185.932C197.47 249.971 213.268 253.54 223.927 257.96C295.538 287.646 315.295 386.133 256.923 438.757C245.694 448.875 233.206 456.055 218.928 460.924C205.939 465.343 200.24 465.823 186.932 467.093C183.402 467.433 181.792 468.053 177.933 467.833C154.226 466.483 132.669 461.374 112.941 447.486C98.9028 437.607 85.4745 423.369 77.7555 407.931C56.5782 365.576 68.0168 310.483 102.262 278.287C114.731 266.569 132.279 256.91 148.937 252.85L163.935 250.161ZM228.926 270.948C212.918 263.589 208.639 261.549 190.931 259.779L183.932 259.139H177.933H169.934L150.946 261.769C145.377 263.089 145.667 264.999 141.897 266.369L133.938 268.078C130.109 269.488 124.2 272.958 125.849 277.857C126.799 280.687 130.519 282.846 129.609 285.636C128.089 290.266 112.241 292.335 121.09 299.074C122.39 300.064 123.48 300.364 124.94 300.944C127.069 297.795 130.009 292.765 133.938 291.835C136.198 291.295 138.428 292.245 140.518 292.955L146.597 294.965C150.746 297.685 150.356 304.624 149.936 308.943L140.958 306.313L132.809 312.863L126.939 315.782L112.661 328.981L109.941 335.94C102.692 330.84 94.7234 332.62 92.9436 341.939C104.332 342.229 101.692 346.498 102.742 351.938L104.942 358.937L96.8531 353.348L86.3244 348.518L77.9455 337.939C74.266 346.778 74.8359 357.497 74.9459 366.936C75.3358 399.922 100.193 433.477 128.939 447.956C169.334 468.293 221.137 461.734 253.883 429.838C272.071 412.13 283.209 385.263 282.92 359.937C282.87 355.747 281.64 344.269 278.49 341.539C277.16 340.389 268.351 338.569 265.922 337.939C269.821 342.759 271.271 342.419 276.92 343.939C274.951 347.288 264.902 357.237 260.742 355.017C257.543 353.308 257.603 349.118 251.923 345.938C252.833 354.007 257.713 362.436 266.922 359.937C266.892 367.296 260.482 370.925 256.993 376.935C252.993 383.814 254.533 387.303 253.613 390.893C252.773 394.162 250.674 395.252 249.004 398.022C246.444 402.261 247.034 405.791 242.705 410.93C240.485 413.56 235.496 418.639 231.646 417.729C224.327 416.01 220.217 399.512 219.728 392.933C219.528 390.223 220.197 388.443 220.397 385.933C220.607 383.364 220.267 381.424 219.688 378.934C219.258 377.065 218.568 374.625 217.648 372.955C210.219 359.367 196.6 374.955 186.582 362.636C177.753 351.778 186.452 333.37 197.94 328.421C200.94 327.131 210.839 324.211 213.758 325.241C216.398 326.171 220.207 331.41 226.927 330.53L231.926 329.131C234.826 328.771 239.815 328.941 242.925 329.131V325.941C233.506 325.171 237.705 319.312 240.135 318.052C242.845 316.652 244.694 318.652 250.924 316.942C247.774 313.043 242.185 309.023 237.555 313.453C235.246 315.672 233.086 322.911 229.456 321.042L225.927 316.942L220.927 320.942C220.467 319.412 220.427 318.532 219.338 317.172C213.508 309.913 206.479 320.642 201.93 322.181C197.42 323.711 193.771 320.252 195.101 317.162C196.75 313.313 204.189 314.792 202.6 308.003C201.38 302.804 196.41 305.934 194.841 303.424C193.561 301.374 197.82 296.025 198.93 293.945C206.309 298.524 205.469 305.754 211.709 300.514C212.748 299.634 213.128 298.924 213.928 297.945C212.448 296.245 210.459 294.465 210.399 292.035C210.339 289.406 218.318 279.247 220.437 277.547C224.577 274.218 225.987 277.887 228.926 270.948ZM194.931 264.959C192.211 274.208 183.562 280.017 175.933 284.946C173.013 286.826 168.734 290.126 165.464 287.336C160.645 283.416 165.184 277.307 165.464 274.947C166.304 270.218 159.295 265.389 168.934 264.959H171.934H194.931ZM143.937 289.946C140.118 280.437 138.378 282.736 137.168 279.687C136.058 276.897 138.618 272.888 141.887 273.688C145.277 274.518 151.006 282.157 149.546 285.736C148.627 288.006 145.977 288.986 143.937 289.946ZM238.925 281.947C238.055 276.967 236.695 276.757 231.926 275.947C233.496 280.407 234.246 281.167 238.925 281.947ZM223.877 291.145C216.728 293.505 217.828 299.734 222.927 299.154C227.337 298.644 229.716 293.285 223.877 291.145ZM135.938 433.927C129.969 432.118 129.159 428.318 126.799 422.929L120.65 406.931C119.23 401.391 121.02 399.352 116.831 392.933C113.531 387.873 104.652 379.894 103.912 373.935C103.342 369.356 111.021 356.817 116.981 356.097C120.49 355.677 122.82 357.237 125.939 358.297C131.679 360.247 135.728 359.727 140.768 364.276C143.847 367.066 145.777 370.955 149.026 373.215C153.356 376.215 158.225 374.885 161.195 379.074C164.365 383.564 160.355 387.673 158.925 391.933C158.235 393.972 157.945 396.792 156.356 398.332C154.966 399.672 153.666 399.642 151.936 399.932C149.896 415.02 142.447 417.229 139.248 423.029L135.938 433.927ZM252.923 407.931C253.163 405.221 253.413 403.541 254.283 400.932C254.843 399.242 255.563 397.472 256.453 395.932C257.543 394.062 260.642 389.573 263.512 391.103C265.452 392.313 264.392 396.192 263.512 397.932C261.572 403.241 258.683 406.991 252.923 407.931ZM329.854 430.928C330.074 433.027 330.803 436.727 329.854 438.537C328.644 440.646 321.375 444.086 318.915 445.526L286.919 462.174C282.8 464.233 272.071 471.443 268.661 465.773C266.902 462.844 269.761 460.814 271.941 459.394L288.919 450.505L305.917 441.626C312.516 438.147 322.774 431.688 329.854 430.928ZM73.946 462.924L34.951 444.176C31.6714 442.526 22.5925 438.837 26.972 433.537C29.5416 430.428 38.0606 435.637 40.9502 437.037C46.5795 439.767 65.0171 448.585 68.5667 452.255C71.5263 455.305 73.1161 458.834 73.946 462.924ZM30.3815 453.075C34.9109 452.395 38.1106 455.475 38.7105 459.924C39.8903 466.853 36.8107 472.472 38.7105 480.921C40.7602 490.96 46.5095 498.949 53.9485 505.828L62.3575 512.677C64.5772 515.417 62.8474 520.386 59.7378 521.766C55.2484 523.756 43.9998 513.937 40.9602 510.908C28.4618 498.399 24.5523 484.121 26.672 466.923C27.2619 462.134 26.762 456.674 30.3815 453.075ZM327.914 452.925C331.733 474.232 332.063 493.35 315.895 509.918C312.666 513.237 301.307 524.986 296.298 520.546C293.218 517.477 292.758 513.907 296.298 510.808L302.917 505.458C307.986 501.229 314.586 493.19 316.815 486.921C318.085 483.321 318.815 478.732 318.905 474.922C319.125 465.183 313.846 454.895 327.914 452.925ZM78.9454 463.924C81.0951 462.654 83.2748 461.084 85.9245 461.484C91.5538 462.344 90.6439 468.853 84.9446 468.143C83.5548 467.973 80.3652 466.523 78.9454 465.923V463.924ZM53.9985 471.943C57.2481 470.833 60.8077 470.283 63.7973 472.522C68.3167 475.902 67.7568 484.141 62.8374 486.901C54.6785 491.48 43.1799 480.191 53.9985 471.943ZM293.978 471.943C297.168 470.853 300.767 470.263 303.687 472.522C308.616 476.322 307.936 486.511 299.877 487.681C290.449 489.06 286.249 477.972 293.978 471.943ZM97.543 477.942C101.762 476.142 108.272 476.922 112.941 476.922H144.937H254.923C256.913 476.922 260.732 476.692 262.322 477.942C263.352 478.762 263.572 479.762 263.772 480.981C264.182 483.391 264.362 490.28 262.322 491.9C260.732 493.15 256.913 492.92 254.923 492.92H165.934L154.936 492L144.937 492.93H107.942H98.2529C94.4234 491.76 95.6633 480.561 97.543 477.942ZM68.9466 533.915C69.2966 518.377 79.5453 506.158 94.9433 503.149C98.3929 502.759 103.352 502.879 106.942 503.149L121.94 503.918H158.935L175.933 502.919H253.923C266.932 502.939 276 505.358 284.579 515.917C286.959 518.847 293.188 530.695 289.309 533.895C287.779 535.144 283.859 534.915 281.92 534.915H180.932L159.065 533.605C155.966 532.755 155.616 530.615 152.806 529.505L137.938 527.915H94.9433C88.9041 527.915 81.685 526.556 76.9456 530.915L80.9451 532.915L68.9466 533.915ZM121.94 530.915H142.937C146.907 530.925 148.627 530.475 151.936 532.915H121.94V530.915ZM62.2575 543.933C67.0169 542.124 75.6058 542.914 80.9451 542.914H117.94H245.924H292.918C300.407 543.053 299.907 545.173 299.917 551.912V574.909C299.907 576.729 300.067 579.829 298.897 581.309C297.328 583.288 293.218 582.908 290.919 582.908H191.931L176.933 581.909L154.936 580.909H113.941L77.9455 581.669C75.5258 581.809 62.9774 582.878 61.5476 581.669C59.5778 580.419 59.9478 576.099 59.9478 573.91V551.912C59.9778 548.013 59.5378 546.853 62.2575 543.933ZM46.9494 590.387L84.9446 590.907H134.938L151.936 589.908H253.923H273.921L287.919 590.907L301.917 589.908C308.086 589.838 315.565 589.478 320.585 593.707C323.164 595.877 327.824 603.986 324.304 606.885C322.774 608.135 318.855 607.905 316.915 607.905H171.934L156.935 606.905H129.939L112.941 605.906H76.9456L63.9473 606.905H44.9497C43.2499 606.905 39.7303 607.035 38.2605 606.306C35.7309 605.056 36.1108 602.216 36.6407 599.906C38.0406 593.687 41.1202 591.797 46.9494 590.387Z" fill="hsl(49, 80%, 46%)" stroke="hsl(49, 80%, 46%)" stroke-width="0.02"></path></svg>');function Ci(n){var e=ki();ut(n,e)}function Ei(n,e){x(e,!H(e))}var Si=(n,e)=>x(e,!1),Oi=(n,e)=>x(e,!1),Ti=(n,e,t)=>{x(e,5),t("/about")},Ai=(n,e)=>x(e,!1),Ri=(n,e)=>x(e,!1),ji=(n,e,t)=>{x(e,4),t("/reviews")},Ii=(n,e)=>x(e,!1),Pi=(n,e)=>x(e,!1),xi=(n,e,t)=>{x(e,3),t("/services")},$i=(n,e)=>x(e,!1),Li=(n,e)=>x(e,!1),Ui=(n,e,t)=>{x(e,2),t("/contact")},Ni=(n,e)=>x(e,!1),Di=(n,e)=>x(e,!1),qi=(n,e,t)=>{x(e,1),t("/")},Bi=(n,e)=>x(e,!1),Mi=sr('<div class="navbar svelte-vny38x"><nav><ul class="svelte-vny38x"><li class="svelte-vny38x"><button class="svelte-vny38x"><a href="/about">About</a></button></li> <li class="svelte-vny38x"><button class="svelte-vny38x"><a href="/reviews">Projects</a></button></li> <li class="svelte-vny38x"><button class="svelte-vny38x"><a href="/services">Services</a></button></li> <li class="svelte-vny38x"><button class="svelte-vny38x"><a href="/contact">Contact</a></button></li> <li class="svelte-vny38x"><button class="svelte-vny38x"><a href="/">Home</a></button></li></ul></nav> <button class="svelte-vny38x"><div class="burger svelte-vny38x"><svg class="svelte-vny38x"><!></svg></div></button></div>');function Hi(n,e){rr(e,!0);let t=bt(!1),r=bt(0);function s(re){re.startsWith("/")||re.startsWith("http")?Hr(re,{noScroll:!0}):console.error("Invalid URL:",re)}var i=Mi(),o=I(i);let a;var l=I(o),c=I(l),u=I(c);u.__click=[Si,t],u.__keydown=[Oi,t];var h=I(u);h.__click=[Ti,r,s];let d;P(u),P(c);var f=pe(c,2),g=I(f);g.__click=[Ai,t],g.__keydown=[Ri,t];var p=I(g);p.__click=[ji,r,s];let _;P(g),P(f);var w=pe(f,2),v=I(w);v.__click=[Ii,t],v.__keydown=[Pi,t];var y=I(v);y.__click=[xi,r,s];let m;P(v),P(w);var E=pe(w,2),C=I(E);C.__click=[$i,t],C.__keydown=[Li,t];var O=I(C);O.__click=[Ui,r,s];let $;P(C),P(E);var L=pe(E,2),te=I(L);te.__click=[Ni,t],te.__keydown=[Di,t];var pt=I(te);pt.__click=[qi,r,s];let _t;P(te),P(L),P(l),P(o);var Pe=pe(o,2);Pe.__click=[Ei,t],Pe.__keydown=[Bi,t];var vt=I(Pe),wt=I(vt),Ir=I(wt);Ci(Ir),P(wt),P(vt),P(Pe),P(i),qr((re,Pr,xr,$r,Lr,Ur)=>{a=se(o,1,"svelte-vny38x",null,a,re),d=se(h,1,"svelte-vny38x",null,d,Pr),_=se(p,1,"svelte-vny38x",null,_,xr),m=se(y,1,"svelte-vny38x",null,m,$r),$=se(O,1,"svelte-vny38x",null,$,Lr),_t=se(pt,1,"svelte-vny38x",null,_t,Ur)},[()=>({open:H(t)}),()=>({current:H(r)===5}),()=>({current:H(r)===4}),()=>({current:H(r)===3}),()=>({current:H(r)===2}),()=>({current:H(r)===1})]),ut(n,i),nr()}Mr(["click","keydown"]);var Fi=sr('<div class="app"><!> <main><!></main></div>');function no(n,e){rr(e,!0);let t=mt(()=>e.data.session),r=mt(()=>e.data.supabase);Nr(()=>{const{data:l}=H(r).auth.onAuthStateChange((c,u)=>{u?.expires_at!==H(t)?.expires_at&&Fr("supabase:auth")});return()=>l.subscription.unsubscribe()});var s=Fi(),i=I(s);Hi(i,{});var o=pe(i,2),a=I(o);Br(a,()=>e.children),P(o),P(s),ut(n,s),nr()}export{no as component,so as universal};
